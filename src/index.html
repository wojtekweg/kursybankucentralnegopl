<html>
	<head>
	</head>
	<body>
		<header>
			<h1>kursybankucentralnego.pl</h1>
			<nav>
				<a href = "index.html">Przelicznik walut</a> |
				<a href = "gold.html">Kurs złota</a> |
				<a href = "chart.html">Wykresy walut</a> |
				<a href = "about.html">O stronie</a>
			</nav>
		</header>
		<main>
			<input type = "date" min = "2002-01-02" id = "dateInput" onchange = "setDate()"></date>
			<span id = "dateSpan"></span>
			<br>
			<br>
			<select id = "leftSelect" disabled >
				<option>PLN</option>
			</select>
			<input type = "number" min = "0" step = "0.01" value = "0" id = "moneyInput" disabled>
			<select id = "rightSelect" disabled>
				<option>PLN</option>
			</select>
			<br>
			<br>
			<input type = "button" value = "Przelicz" id = "convertInput" onclick = "convert()" disabled>
			<br>
			<br>
			<input type = "number" min = "0" step = "0.01" value = "0" id = "resultInput" disabled>
			
			<script src = "TableNBP.js"></script>
			<script>
				
				dateInput.max = TableNBP.format(new Date())
				dateInput.value = dateInput.max
				setDate()
				
				function setDate(){
					dateSpan.innerHTML = ""
					leftSelect.disabled = true
					moneyInput.disabled = true
					rightSelect.disabled = true
					convertInput.disabled = true
					resultInput.disabled = true
					actual = new TableNBP(dateInput.value, ready);
				}
				
				function ready(table){
					leftSelect.disabled = false
					moneyInput.disabled = false
					rightSelect.disabled = false
					convertInput.disabled = false
					resultInput.disabled = false
					if (table[0].effectiveDate != dateInput.value){
						dateInput.value = table[0].effectiveDate
						dateSpan.innerHTML = "Data została zmieniona na najnowszą poprzednią dostępną"
					}
					inner = "<option value = \"1\">PLN</option>"
					for (i = 0; i < table[0].rates.length; ++i){
						inner += `<option value = \"${table[0].rates[i].mid}\">${table[0].rates[i].code}</option>`
					}
					leftSelect.innerHTML = rightSelect.innerHTML = inner
				}
				
				function convert() {
					if (leftSelect.value == rightSelect.value){
						resultInput.value = moneyInput.value
					} else {
						resultInput.value = (moneyInput.value * leftSelect.value / rightSelect.value).toFixed(2);
					}
				}
				
			</script>
		</main>
		<footer>
			Done by Zofia Błażyca, Wojciech Węgrzyn, Dawid Moza
		</footer>
	</body>
</html>